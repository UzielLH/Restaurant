<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Gerente - Restaurant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/gerente_styles.css') }}">
</head>
<body>
    <div class="gerente-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Panel Gerente</h2>
                <p class="gerente-name">{{ empleado.nombre }}</p>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-section="productos">
                    <span class="icon">üçΩÔ∏è</span>
                    Gesti√≥n de Platillos
                </a>
                <a href="#" class="nav-item" data-section="descuentos">
                    <span class="icon">üè∑Ô∏è</span>
                    Descuentos
                </a>
                <a href="#" class="nav-item" data-section="ordenes">
                    <span class="icon">üìã</span>
                    Generar √ìrdenes
                </a>
            </nav>
            <div class="sidebar-footer">
                <button class="btn-logout" onclick="cerrarSesionGerente()">Cerrar Sesi√≥n</button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Gesti√≥n de Platillos Section -->
            <section id="productos" class="content-section active">
                <div class="section-header">
                    <h1>Gesti√≥n de Platillos</h1>
                    <p>Edita informaci√≥n y costos de los productos</p>
                </div>

                <div class="filters-bar">
                    <div class="search-box">
                        <input type="text" id="buscar-producto" placeholder="Buscar platillo..." class="form-control">
                    </div>
                    <div class="filter-category">
                        <select id="filtro-categoria" class="form-control">
                            <option value="">Todas las categor√≠as</option>
                        </select>
                    </div>
                    <div class="filter-status">
                        <select id="filtro-status" class="form-control">
                            <option value="">Todos los estados</option>
                            <option value="disponible">Disponible</option>
                            <option value="fuera de servicio">Fuera de Servicio</option>
                        </select>
                    </div>
                </div>

                <div class="productos-grid" id="productos-grid">
                    <!-- Los productos se cargar√°n din√°micamente -->
                </div>

                <!-- Modal Editar Producto -->
                <div id="modal-editar-producto" class="modal">
                    <div class="modal-content large">
                        <span class="close" onclick="cerrarModalEditarProducto()">&times;</span>
                        <h2>Editar Platillo</h2>
                        <form id="form-editar-producto">
                            <input type="hidden" id="edit-producto-id">
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Nombre del Platillo *</label>
                                    <input type="text" id="edit-producto-nombre" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label>Categor√≠a *</label>
                                    <select id="edit-producto-categoria" class="form-control" required>
                                        <option value="">Seleccionar categor√≠a</option>
                                    </select>
                                </div>
                            </div>

                            <div class="pricing-calculator">
                                <h3 style="margin-bottom: 15px; color: #667eea;">üí∞ Calculadora de Precio</h3>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Costo del Producto *</label>
                                        <input type="number" id="edit-producto-costo" class="form-control" 
                                            step="0.01" min="0" required 
                                            placeholder="Ej: 50.00">
                                        <small style="color: #666;">Costo de adquisici√≥n o producci√≥n</small>
                                    </div>
                                    <div class="form-group">
                                        <label>Ganancia Deseada *</label>
                                        <input type="number" id="edit-producto-ganancia" class="form-control" 
                                            step="0.01" min="0" value="0"
                                            placeholder="Ej: 20.00">
                                        <small style="color: #666;">Cu√°nto desea ganar por unidad</small>
                                    </div>
                                </div>

                                <div class="price-preview">
                                    <div class="preview-item">
                                        <span>Costo + IVA (16%):</span>
                                        <span id="edit-costo-iva-preview">Se calcular√° autom√°ticamente</span>
                                    </div>
                                    <div class="preview-item final">
                                        <span>Precio de Venta Final:</span>
                                        <span id="edit-precio-calculado-preview" style="font-size: 24px; font-weight: bold; color: #28a745;">$0.00</span>
                                    </div>
                                </div>

                                <div style="background: #e7f3ff; padding: 12px; border-radius: 8px; margin-top: 10px;">
                                    <small style="color: #0066cc;">
                                        ‚ÑπÔ∏è <strong>F√≥rmula:</strong> Precio Final = (Costo √ó 1.16) + Ganancia
                                    </small>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Precio en Puntos (Opcional)</label>
                                    <input type="number" id="edit-producto-puntos" class="form-control" 
                                        min="0" placeholder="Ej: 150">
                                    <small style="color: #666;">Puntos necesarios para canjear</small>
                                </div>
                                <div class="form-group">
                                    <label>URL de Imagen</label>
                                    <input type="url" id="edit-producto-img" class="form-control" 
                                        placeholder="https://ejemplo.com/imagen.jpg">
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Descripci√≥n</label>
                                <textarea id="edit-producto-descripcion" class="form-control" rows="3"
                                        placeholder="Descripci√≥n del producto..."></textarea>
                            </div>

                            <div class="form-group">
                                <label>Estado del Producto</label>
                                <select id="edit-producto-status" class="form-control" required>
                                    <option value="disponible">Disponible</option>
                                    <option value="fuera de servicio">Fuera de Servicio</option>
                                </select>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="cerrarModalEditarProducto()">Cancelar</button>
                                <button type="submit" class="btn btn-primary">üíæ Guardar Cambios</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Descuentos Section -->
            <section id="descuentos" class="content-section">
                <div class="section-header">
                    <h1>Gesti√≥n de Descuentos por Cliente</h1>
                    <button class="btn btn-primary" onclick="mostrarModalDescuentoGerente()">+ Nuevo Descuento</button>
                </div>

                <div class="table-container">
                    <table id="tabla-descuentos-gerente">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Correo</th>
                                <th>Descuento</th>
                                <th>Fecha Inicio</th>
                                <th>Fecha Expiraci√≥n</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Modal Crear Descuento (FUERA de la secci√≥n, al final antes del cierre de main) -->
            <div id="modal-descuento-gerente" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="cerrarModalDescuentoGerente()">&times;</span>
                    <h2 id="modal-descuento-titulo">Nuevo Descuento</h2>
                    <form id="form-descuento-gerente">
                        <div class="form-group">
                            <label>Cliente (Opcional)</label>
                            <select id="descuento-cliente-gerente" class="form-control">
                                <option value="">Descuento general (sin cliente espec√≠fico)</option>
                            </select>
                            <small style="color: #666;">Si no selecciona un cliente, el descuento ser√° general</small>
                        </div>
                        <div class="form-group">
                            <label>Porcentaje de Descuento * (0-100)</label>
                            <input type="number" id="descuento-porcentaje-gerente" class="form-control" 
                                min="0" max="100" step="0.01" required 
                                placeholder="Ej: 15.5">
                        </div>
                        <div class="form-group">
                            <label>Fecha de Expiraci√≥n (Opcional)</label>
                            <input type="date" id="descuento-fecha-fin-gerente" class="form-control">
                            <small style="color: #666;">Si no se especifica, el descuento no expirar√°</small>
                        </div>
                        <div class="form-group">
                            <label>Notas (Opcional)</label>
                            <textarea id="descuento-notas-gerente" class="form-control" rows="3" 
                                    placeholder="Motivo del descuento, condiciones, etc."></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="cerrarModalDescuentoGerente()">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Guardar Descuento</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Generar √ìrdenes Section -->
            <section id="ordenes" class="content-section">
                <div class="section-header">
                    <h1>Punto de Venta</h1>
                    <p>Accede al sistema completo de cajero</p>
                </div>

                <div class="cajero-access-container" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 400px; gap: 30px;">
                    <div style="text-align: center;">
                        <div style="font-size: 80px; margin-bottom: 20px;">üßæ</div>
                        <h2 style="color: #667eea; margin-bottom: 15px;">Sistema de Punto de Venta</h2>
                        <p style="color: #666; max-width: 600px; line-height: 1.6;">
                            Accede al sistema completo de cajero: configura caja inicial, crea √≥rdenes, 
                            procesa pagos, gestiona clientes y realiza cierre de caja.
                        </p>
                    </div>

                    <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center; min-width: 180px;">
                            <div style="font-size: 30px; margin-bottom: 10px;">üí∞</div>
                            <div style="font-weight: bold; color: #333;">Caja Inicial</div>
                            <div style="font-size: 13px; color: #666;">Configura monto inicial</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center; min-width: 180px;">
                            <div style="font-size: 30px; margin-bottom: 10px;">üì¶</div>
                            <div style="font-weight: bold; color: #333;">Crear √ìrdenes</div>
                            <div style="font-size: 13px; color: #666;">Gestiona productos</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center; min-width: 180px;">
                            <div style="font-size: 30px; margin-bottom: 10px;">üí≥</div>
                            <div style="font-weight: bold; color: #333;">Procesar Pagos</div>
                            <div style="font-size: 13px; color: #666;">Efectivo, puntos y descuentos</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center; min-width: 180px;">
                            <div style="font-size: 30px; margin-bottom: 10px;">üìä</div>
                            <div style="font-weight: bold; color: #333;">Cierre de Caja</div>
                            <div style="font-size: 13px; color: #666;">Registra ventas del turno</div>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="abrirCajeroGerente()" style="font-size: 18px; padding: 15px 40px; min-width: 300px;">
                        üöÄ Abrir Punto de Venta Completo
                    </button>
                    
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; border-left: 4px solid #2196f3; max-width: 500px;">
                        <small style="color: #1565c0;">
                            <strong>‚ÑπÔ∏è Nota:</strong> Al abrir el punto de venta, tendr√°s acceso completo a todas las funciones del cajero, 
                            incluyendo configuraci√≥n de caja inicial y cierre de caja. Un bot√≥n especial te permitir√° regresar a este men√∫.
                        </small>
                    </div>
                </div>
            </section>

        </main>
    </div>

        <!-- Modal Caja Inicial (agregar ANTES del cierre de body) -->
    <div id="modal-caja-inicial-gerente" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>üí∞ Monto inicial de caja</h2>
            <p>¬øCon cu√°nto dinero inicia la caja?</p>
            <input type="number" id="monto-caja-gerente" step="0.01" min="200" placeholder="M√≠nimo $200.00" class="form-control" style="font-size: 18px; text-align: center; padding: 15px;">
            <div style="margin-top: 10px; padding: 10px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                <small style="color: #856404;">
                    ‚ö†Ô∏è <strong>Importante:</strong> Este monto ser√° el que se registre como inicial en el sistema de caja.
                </small>
            </div>
            <div class="form-actions" style="margin-top: 20px;">
                <button onclick="cerrarModalCajaGerente()" class="btn btn-secondary">Cancelar</button>
                <button onclick="confirmarCajaGerente()" class="btn btn-primary">Confirmar e Iniciar</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/gerente_dashboard.js') }}"></script>
</body>
</html>